# é˜¿é‡Œäº‘éƒ¨ç½²æŒ‡å—

## ğŸ“‹ å‰ç½®æ¡ä»¶

1. é˜¿é‡Œäº‘è´¦å·ï¼ˆå·²å®åè®¤è¯ï¼‰
2. å·²è´­ä¹° ECS æœåŠ¡å™¨ï¼ˆæ¨è 2æ ¸4Gï¼‰
3. åŸŸåï¼ˆå¯é€‰ï¼Œç”¨äº HTTPSï¼‰

---

## ğŸ›’ ç¬¬ä¸€æ­¥ï¼šè´­ä¹°äº‘æœåŠ¡

### 1.1 è´­ä¹° ECS æœåŠ¡å™¨

1. ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å° â†’ äº‘æœåŠ¡å™¨ ECS
2. è´­ä¹°é…ç½®ï¼š
   - **åœ°åŸŸ**: åä¸œ1ï¼ˆæ­å·ï¼‰æˆ–ç¦»ç”¨æˆ·æœ€è¿‘çš„åœ°åŸŸ
   - **å®ä¾‹è§„æ ¼**: ecs.t6-c1m2.largeï¼ˆ2æ ¸4Gï¼‰æˆ–æ›´é«˜
   - **é•œåƒ**: Ubuntu 22.04 LTS
   - **ç³»ç»Ÿç›˜**: 40GB SSD
   - **å¸¦å®½**: æŒ‰é‡ä»˜è´¹ æˆ– 5Mbps å›ºå®šå¸¦å®½
3. è®¾ç½® root å¯†ç æˆ– SSH å¯†é’¥
4. å®‰å…¨ç»„å¼€æ”¾ç«¯å£ï¼š**22, 80, 443, 3000**

### 1.2 è´­ä¹° RDS PostgreSQLï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ç‹¬ç«‹æ•°æ®åº“ï¼š
1. äº‘æ•°æ®åº“ RDS â†’ åˆ›å»ºå®ä¾‹
2. é€‰æ‹© PostgreSQL 15
3. è§„æ ¼ï¼š1æ ¸1G åŸºç¡€ç‰ˆï¼ˆçº¦50å…ƒ/æœˆï¼‰
4. åˆ›å»ºæ•°æ®åº“å’Œè´¦å·

---

## ğŸ”§ ç¬¬äºŒæ­¥ï¼šæœåŠ¡å™¨ç¯å¢ƒé…ç½®

### 2.1 SSH è¿æ¥æœåŠ¡å™¨

```bash
ssh root@ä½ çš„æœåŠ¡å™¨IP
```

### 2.2 å®‰è£… Docker

```bash
# æ›´æ–°ç³»ç»Ÿ
apt update && apt upgrade -y

# å®‰è£… Docker
curl -fsSL https://get.docker.com | sh

# å®‰è£… Docker Compose
apt install docker-compose -y

# å¯åŠ¨ Docker
systemctl enable docker
systemctl start docker

# éªŒè¯å®‰è£…
docker --version
docker-compose --version
```

### 2.3 å®‰è£… Node.jsï¼ˆç”¨äºæ„å»ºï¼‰

```bash
# å®‰è£… Node.js 20
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install nodejs -y

# éªŒè¯
node --version
npm --version
```

---

## ğŸ“¤ ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ ä»£ç 

### æ–¹å¼ä¸€ï¼šGit æ‹‰å–ï¼ˆæ¨èï¼‰

```bash
# å®‰è£… Git
apt install git -y

# å…‹éš†ä»£ç ï¼ˆå¦‚æœä»£ç åœ¨ Git ä»“åº“ï¼‰
cd /opt
git clone ä½ çš„ä»“åº“åœ°å€ ai-platform
cd ai-platform/AIèƒ½åŠ›äº¤æ˜“å¹³å°
```

### æ–¹å¼äºŒï¼šSCP ä¸Šä¼ 

åœ¨æœ¬åœ°ç”µè„‘æ‰§è¡Œï¼š
```bash
# å‹ç¼©é¡¹ç›®
cd /Users/paranoid/51Talk_Market_Project
tar -czvf ai-platform.tar.gz AIèƒ½åŠ›äº¤æ˜“å¹³å°

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp ai-platform.tar.gz root@æœåŠ¡å™¨IP:/opt/

# åœ¨æœåŠ¡å™¨ä¸Šè§£å‹
ssh root@æœåŠ¡å™¨IP
cd /opt
tar -xzvf ai-platform.tar.gz
```

---

## âš™ï¸ ç¬¬å››æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

```bash
cd /opt/AIèƒ½åŠ›äº¤æ˜“å¹³å°/deploy

# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp env.production.example .env

# ç¼–è¾‘é…ç½®
nano .env
```

å¡«å†™ä»¥ä¸‹é…ç½®ï¼š
```env
# æ•°æ®åº“ï¼ˆå¦‚æœç”¨ RDSï¼Œå¡« RDS è¿æ¥ä¿¡æ¯ï¼‰
DATABASE_URL=postgresql://postgres:ä½ çš„å¯†ç @postgres:5432/ai_platform
DB_PASSWORD=ä½ çš„æ•°æ®åº“å¯†ç 

# JWT å¯†é’¥ï¼ˆéšæœºå­—ç¬¦ä¸²ï¼Œè‡³å°‘32ä½ï¼‰
JWT_SECRET=éšæœºç”Ÿæˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²

# Claude APIï¼ˆä½ ä¹‹å‰ç”¨çš„é‚£ä¸ªï¼‰
ANTHROPIC_API_KEY=sk-or-v1-xxx

# å‰ç«¯åœ°å€
FRONTEND_URL=http://ä½ çš„æœåŠ¡å™¨IP
```

---

## ğŸš€ ç¬¬äº”æ­¥ï¼šæ„å»ºå’Œéƒ¨ç½²

```bash
cd /opt/AIèƒ½åŠ›äº¤æ˜“å¹³å°

# 1. å®‰è£…å‰ç«¯ä¾èµ–å¹¶æ„å»º
npm install
npm run build

# 2. å®‰è£…åç«¯ä¾èµ–å¹¶æ„å»º
cd backend
npm install
npm run build
cd ..

# 3. å¯åŠ¨æœåŠ¡
cd deploy
docker-compose up -d

# 4. æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
docker-compose ps

# 5. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

---

## âœ… ç¬¬å…­æ­¥ï¼šéªŒè¯éƒ¨ç½²

1. **è®¿é—®å‰ç«¯**: http://æœåŠ¡å™¨IP
2. **è®¿é—®API**: http://æœåŠ¡å™¨IP/api/v1
3. **APIæ–‡æ¡£**: http://æœåŠ¡å™¨IP/api-docs

---

## ğŸ” ç¬¬ä¸ƒæ­¥ï¼šé…ç½® HTTPSï¼ˆå¯é€‰ï¼‰

### 7.1 ç”³è¯·å…è´¹ SSL è¯ä¹¦

1. é˜¿é‡Œäº‘æ§åˆ¶å° â†’ SSLè¯ä¹¦ â†’ å…è´¹è¯ä¹¦
2. æˆ–ä½¿ç”¨ Let's Encryptï¼š

```bash
# å®‰è£… certbot
apt install certbot -y

# ç”³è¯·è¯ä¹¦ï¼ˆéœ€è¦å…ˆé…ç½®åŸŸåæŒ‡å‘æœåŠ¡å™¨ï¼‰
certbot certonly --standalone -d ä½ çš„åŸŸå.com

# è¯ä¹¦ä½ç½®
# /etc/letsencrypt/live/ä½ çš„åŸŸå.com/fullchain.pem
# /etc/letsencrypt/live/ä½ çš„åŸŸå.com/privkey.pem
```

### 7.2 é…ç½® Nginx HTTPS

ç¼–è¾‘ `deploy/nginx.conf`ï¼Œå–æ¶ˆæ³¨é‡Š HTTPS éƒ¨åˆ†å¹¶é…ç½®è¯ä¹¦è·¯å¾„ã€‚

---

## ğŸ“Š å¸¸ç”¨è¿ç»´å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend
docker-compose logs -f nginx

# é‡å¯æœåŠ¡
docker-compose restart

# åœæ­¢æœåŠ¡
docker-compose down

# æ›´æ–°ä»£ç åé‡æ–°éƒ¨ç½²
git pull
npm run build
cd backend && npm run build && cd ..
cd deploy && docker-compose up -d --build
```

---

## â— å¸¸è§é—®é¢˜

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥
æ£€æŸ¥ DATABASE_URL é…ç½®æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿æ•°æ®åº“æœåŠ¡æ­£åœ¨è¿è¡Œã€‚

### Q: ç«¯å£æ— æ³•è®¿é—®
æ£€æŸ¥é˜¿é‡Œäº‘å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾äº†å¯¹åº”ç«¯å£ï¼ˆ80, 443, 3000ï¼‰ã€‚

### Q: å‰ç«¯è®¿é—®ç©ºç™½
æ£€æŸ¥ nginx æ—¥å¿—ï¼š`docker-compose logs nginx`

---

## ğŸ’° è´¹ç”¨ä¼°ç®—

| æœåŠ¡ | è§„æ ¼ | æœˆè´¹ç”¨ |
|------|------|--------|
| ECS | 2æ ¸4G | ~100å…ƒ |
| RDSï¼ˆå¯é€‰ï¼‰ | 1æ ¸1G | ~50å…ƒ |
| å¸¦å®½ | 5Mbps | ~50å…ƒ |
| åŸŸå | .com | ~5å…ƒ/æœˆ |
| **åˆè®¡** | | **~150-200å…ƒ/æœˆ** |

å¦‚æœä¸ç”¨ RDSï¼Œç›´æ¥ç”¨ Docker é‡Œçš„ PostgreSQLï¼Œå¯ä»¥çœå»æ•°æ®åº“è´¹ç”¨ã€‚

